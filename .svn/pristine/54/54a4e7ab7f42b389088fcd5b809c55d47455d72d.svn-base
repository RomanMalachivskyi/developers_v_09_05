$(function() {
	var formLogin = $("#formLogin");
	var formRegister = $("#formRegister");
	var btnRegister = $("#btnRegist");
	var btnLogin = $("#btnLogin");
	var divFormLogin = $("#divFormLogin");
	var divFormRegister = $("#divFormRegister");
	var btnLogout = $("#btnLogout");
	
	var getListOfGames = function() {
		$.ajax({
			url: "list-of-games",
			success: function(data) {
				$("#insert").html(data);
			}
		});
	};
	var verifyLogin = function() {
		$.ajax({
			url: "check-login",
			success: function(user) {
				if (null != user) {
					btnLogin.hide();
					btnRegister.hide();
					registerField.show();
					registerField.html("Hello, " + user.name + "!");
					enableBtnProfile();
					btnLogout.show();
				} else {
					btnLogout.hide();
					disableBtnProfile();
				}
			}
		});
	};
	btnRegister.click(function () {
		divFormRegister.toggle('slow');
	});
	
	btnLogin.click(function () {
		divFormLogin.toggle('slow');
	});
	var init = function() {
		verifyLogin();
	};
	
	btnLogout.click(function() {
		$.ajax({
			url: "logout",
			success: function(data) {
				location.reload();
			}
		});
	});
	
	formLogin.submit( function(){
		$.ajax({
			url: "login",
			contentType: "application/x-www-form-urlencoded",
			dataType: "text",
			data: formLogin.serialize(),
			success: function(data) {
				divFormLogin.hide();
				verifyLogin();
			},
			error: function(error) {
				$("#errorLogin").html(error.responseText);
			}
		});
		return false;
	});
	formRegister.submit(function() {
		$.ajax({
			url: "register",
			contentType: "application/x-www-form-urlencoded",
			dataType: "text",
			data: formRegister.serialize(),
			success: function(data) {
				location.reload();
			},
			error: function(error) {
				$("#errorName").html(error.responseText);
			}
		});
		return false;
	});
	
	init();
	
	//getListOfGames();
	
});
