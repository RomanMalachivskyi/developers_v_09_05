package com.epam.lab.developers.game;

import java.util.ArrayList;
import java.util.List;
import java.util.TimerTask;

import com.epam.lab.developers.entity.User;
import com.epam.lab.developers.game.map.object.MapObject;


public class GameTask extends TimerTask {

	private Game game;
	private List<Active> activeList = new ArrayList<>();
		
	public GameTask(Game game) {
		super();
		this.game = game;
		for(User user: game.getPlayers())
			activeList.addAll(user.getTeam().getUnits());
//		for(MapObject[] tmpArray : game.getMap().getMapObjects())
//			for(MapObject tmpObj : tmpArray)
//				if(tmpObj instanceof Active) activeList.add((Active)tmpObj);	
		
	}

	@Override
	public void run() {		
		for (Active object : activeList){			
				object.action();			
		}				
		for(User user: game.getPlayers())
			if(user.getTeam().getCodeLines()>=game.CODE_LINES)
				this.cancel();		
	}
	
	public Game getGame() {
		return game;
	}

	public void setGame(Game game) {
		this.game = game;
	}

}
