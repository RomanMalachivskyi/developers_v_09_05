package com.epam.lab.developers.tests;

import org.junit.Before;
import org.junit.Test;

import com.epam.lab.developers.data.DataHolder;
import com.epam.lab.developers.data.LoginData;
import com.gargoylesoftware.htmlunit.NicelyResynchronizingAjaxController;

import net.sourceforge.jwebunit.htmlunit.HtmlUnitTestingEngineImpl;
import net.sourceforge.jwebunit.junit.WebTester;

public class ConnectToGameTest {

	private WebTester tester;
	
	@Before
	public void prepare() {
		tester = new WebTester();
		tester.setBaseUrl("http://localhost:8080/developers");
	}
	
	@Test
	public void test() {
		tester.beginAt("/home");
		
		if (tester.getTestingEngine() instanceof HtmlUnitTestingEngineImpl) {
			((HtmlUnitTestingEngineImpl) tester.getTestingEngine()).getWebClient().setAjaxController(new NicelyResynchronizingAjaxController());
		}
		
		tester.assertFormPresent("formLogin");
		tester.setTextField("name_login", "ostap");
		tester.setTextField("password_login", "123");
		tester.assertTextFieldEquals("name_login", "ostap");
		tester.assertTextFieldEquals("password_login", "123");
		tester.assertButtonPresent("s_Login");
		tester.clickButton("s_Login");
		
		tester.gotoPage("/profile");
		
		tester.assertTitleEquals("Developers - Profile");
	}
	
}
