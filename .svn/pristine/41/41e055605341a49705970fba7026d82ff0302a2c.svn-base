package com.epam.lab.developers.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.epam.lab.developers.game.map.object.ActiveObject;
import com.epam.lab.developers.game.map.object.CoffeMashine;

public class ActiveObjectDAO extends MapItemDAOJdbc<ActiveObject> {

	private String getTeamObjsById = "SELECT team_object.rotation_angle, team_object.i, team_object.j, object.path, object.name "
			+ "FROM team_object INNER JOIN object ON team_object.id_team = ? "
			+ "AND team_object.id_object = object.id ORDER BY team_object.i, team_object.j";
	
			
	@Override
	public List<ActiveObject> getAllByTeamId(int id) throws SQLException {	
		
		PreparedStatement	stat = conn.prepareStatement(getTeamObjsById);
		stat.setInt(1, id);
		ResultSet rs = stat.executeQuery();
		
		return createObjectList(rs);
	}

	@Override
	public List<ActiveObject> getAllByMapId(int id) {
		// TODO Auto-generated method stub
		return null;
	}
	
	private List<ActiveObject> createObjectList(ResultSet rs) throws SQLException{
		List<ActiveObject> objs = new ArrayList<>();
		while(rs.next()){

			objs.add(new CoffeMashine(rs.getInt("i"), rs.getInt("j"), rs.getInt("rotation_angle"), rs.getString("path")));
			
			//			switch(rs.getString("name")){
//			case "" :
//				break;
//			case "1" :
//				break;
//			}
		}
		return objs;
	}

}
